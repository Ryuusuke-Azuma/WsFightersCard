# バグ報告

## 概要 (Title)

Gameの編集画面で日付を変えたときリストが更新されない

## 再現手順 (Steps to Reproduce)

1. スケジュール画面を開き、何らかの大会が登録されている日付を選択する。
2. リストに表示された大会の編集ボタン（３点リーダーから「Edit」）をタップする。
3. 大会編集ダイアログで、「開催日」を別の日に変更する。
4. 「更新」ボタンを押してダイアログを閉じる。

## 本来の挙動 (Expected Behavior)

ユーザーは元の画面（日付）に留まり、その日付の大会リストが更新され、日付を変更した大会がリストから消えるべき。
また、カレンダーのイベントマーカー（ドット）も更新され、古い日付からドットが消え、新しい日付にドットが表示されるべき。

## 実際の挙動 (Actual Behavior)

ダイアログを閉じても、元の画面のリストが更新されず、日付を変更したはずの大会が表示されたままになっている。カレンダーのマーカーも更新されない。

## 環境 (Environment)

- **アプリバージョン:** v1.0
- **OSバージョン:** Android 13

## 原因と修正内容 (Cause and Resolution)

**原因:**
大会の編集後に、UI層（`GamesPageFragment`）がデータの再読み込みを担っていましたが、どの`LocalDate`を再読み込みすべきかという状態を正しく管理できていませんでした。特に、大会の日付自体が変更された場合に、UIは古い日付のリストを更新しようとするため、変更が反映されないという問題が発生していました。

**修正内容:**
- データの再読み込み責務をUI層からViewModel層へ移行しました。
- `GamesViewModel`に、現在表示している日付を保持する`currentDate`プロパティを追加しました。
- 大会の追加・更新・削除後、`GamesViewModel`が自身の`currentDate`を使って、ゲームリストを自動的に再読み込みするように修正しました。UIは`LiveData`を監視するだけになり、状態管理がViewModelに一元化されました。
- これにより、大会の日付を変更しても、表示中の日付リストが正しく更新され、大会がリストから消えるようになりました。
- また、カレンダーのマーカーも、カレンダーダイアログ表示直前に`ScheduleViewModel`が`loadData()`を呼び出すように変更したため、常に最新の状態が反映されるようになりました。

## 深刻度 (Severity)

- [ ] Critical
- [x] Major (主要なデータ編集フローが正しく完了せず、ユーザーにデータの不整合を見せてしまう)
- [ ] Minor
- [ ] Trivial

## ステータス (Status)

- [ ] Open
- [ ] In Progress
- [ ] In Review
- [x] Closed
